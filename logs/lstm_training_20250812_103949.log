2025-08-12 10:39:49,254 - LSTMTraining - INFO - üöÄ LSTM Model Training Started
2025-08-12 10:39:49,254 - LSTMTraining - INFO - Training mode: quick
2025-08-12 10:39:49,254 - LSTMTraining - INFO - Validation split: 0.2
2025-08-12 10:39:49,254 - LSTMTraining - INFO - Starting quick training: Quick training for testing
2025-08-12 10:39:49,254 - LSTMTraining - INFO - Configuration: 50 epochs, batch size 32
2025-08-12 10:39:49,260 - LSTMTraining - WARNING - Could not load data for EUR/USD: 'DataManager' object has no attribute 'get_market_data'
2025-08-12 10:39:49,260 - LSTMTraining - WARNING - Could not load data for GBP/USD: 'DataManager' object has no attribute 'get_market_data'
2025-08-12 10:39:49,260 - LSTMTraining - WARNING - Could not load data for USD/JPY: 'DataManager' object has no attribute 'get_market_data'
2025-08-12 10:39:49,260 - LSTMTraining - WARNING - Could not load data for AUD/USD: 'DataManager' object has no attribute 'get_market_data'
2025-08-12 10:39:49,260 - LSTMTraining - INFO - Using sample data for training
2025-08-12 10:39:49,260 - LSTMTraining - INFO - Creating sample training data...
2025-08-12 10:39:49,283 - LSTMTraining - INFO - Created sample data: 8785 samples from 2024-01-01 00:00:00 to 2025-01-01 00:00:00
2025-08-12 10:39:49,283 - LSTMTraining - INFO - Training data shape: (8785, 6)
2025-08-12 10:39:49,283 - LSTMTraining - INFO - Starting model training...
2025-08-12 10:39:49,283 - LSTM_Model - INFO - Starting model training...
2025-08-12 10:39:53,044 - LSTMTraining - ERROR - ‚ùå Training failed with error: Graph execution error:

Detected at node LogicalAnd_1 defined at (most recent call last):
  File "/workspace/train_lstm.py", line 241, in <module>

  File "/workspace/train_lstm.py", line 225, in main

  File "/workspace/train_lstm.py", line 165, in train_model

  File "/workspace/lstm_model.py", line 260, in train_model

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 85, in train_step

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/trainers/trainer.py", line 490, in compute_metrics

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/trainers/compile_utils.py", line 334, in update_state

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/trainers/compile_utils.py", line 21, in update_state

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/metrics/confusion_metrics.py", line 378, in update_state

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/metrics/metrics_utils.py", line 595, in update_confusion_matrix_variables

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/metrics/metrics_utils.py", line 568, in weighted_assign_add

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/ops/numpy.py", line 4011, in logical_and

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/numpy.py", line 1737, in logical_and

Incompatible shapes: [1,96] vs. [1,32]
	 [[{{node LogicalAnd_1}}]] [Op:__inference_multi_step_on_iterator_9190]
2025-08-12 10:39:53,045 - LSTMTraining - ERROR - Traceback (most recent call last):
  File "/workspace/train_lstm.py", line 165, in train_model
    history = lstm_model.train_model(
        data=training_data,
        validation_split=validation_split,
        epochs=config['epochs']
    )
  File "/workspace/lstm_model.py", line 260, in train_model
    history = self.model.fit(
        X_train, y_train,
    ...<4 lines>...
        verbose=1
    )
  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/utils/traceback_utils.py", line 122, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "/home/ubuntu/.local/lib/python3.13/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    except TypeError as e:
    ...<5 lines>...
      raise e
tensorflow.python.framework.errors_impl.InvalidArgumentError: Graph execution error:

Detected at node LogicalAnd_1 defined at (most recent call last):
  File "/workspace/train_lstm.py", line 241, in <module>

  File "/workspace/train_lstm.py", line 225, in main

  File "/workspace/train_lstm.py", line 165, in train_model

  File "/workspace/lstm_model.py", line 260, in train_model

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/utils/traceback_utils.py", line 117, in error_handler

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 377, in fit

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 220, in function

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 133, in multi_step_on_iterator

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 114, in one_step_on_data

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/trainer.py", line 85, in train_step

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/trainers/trainer.py", line 490, in compute_metrics

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/trainers/compile_utils.py", line 334, in update_state

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/trainers/compile_utils.py", line 21, in update_state

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/metrics/confusion_metrics.py", line 378, in update_state

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/metrics/metrics_utils.py", line 595, in update_confusion_matrix_variables

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/metrics/metrics_utils.py", line 568, in weighted_assign_add

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/ops/numpy.py", line 4011, in logical_and

  File "/home/ubuntu/.local/lib/python3.13/site-packages/keras/src/backend/tensorflow/numpy.py", line 1737, in logical_and

Incompatible shapes: [1,96] vs. [1,32]
	 [[{{node LogicalAnd_1}}]] [Op:__inference_multi_step_on_iterator_9190]

2025-08-12 10:39:53,046 - LSTMTraining - ERROR - üí• Training failed!
